<router-outlet></router-outlet>

<!-- Indicador de carga -->
<div *ngIf="loading" class="p-4 text-center text-gray-600">
  <p>Cargando notificaciones...</p>
</div>
<div *ngIf="!loading" class="notifications-container">
  <!-- Low Stock Section -->
  <div *ngIf="userRole == 'admin'" class="notification-section">
    <h2 class="section-title">
      Bajo Stock
      <span class="notification-count">{{ lowStock.length }}</span>
    </h2>
    <ul>
      <li *ngFor="let notification of lowStock">
        {{ getUpdatedDescription(notification.description) }}
      </li>
    </ul>
  </div>
  <div *ngIf="userRole == 'admin'" class="notification-section">
    <h2 class="section-title">
      Pagos Pendientes
      <span class="notification-count">{{ paymentDues.length }}</span>
    </h2>
    <ul>
      <li
        *ngFor="let notification of paymentDues"
        class="relative p-3 border-b border-gray-100 hover:bg-red-50 transition-colors"
      >
        <div class="flex justify-between items-start">
          <div class="pr-8">
            <p class="font-semibold text-gray-800">
              {{ notification.description }}
            </p>
            <p class="text-xs text-red-500 font-bold mt-1">
              Fecha Límite: {{ notification.due_date | date : "dd-MM-yyyy" }}
            </p>
          </div>

          <button
            class="absolute top-2 right-2 cursor-pointer bg-red-500 text-white rounded p-1 hover:bg-red-600 shadow-sm"
            (click)="deleteNotification(notification)"
            title="Descartar notificación"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="size-5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
              />
            </svg>
          </button>
        </div>
      </li>
      <li
        *ngIf="paymentDues.length === 0"
        class="p-4 text-gray-500 text-sm italic"
      >
        No hay pagos pendientes próximos.
      </li>
    </ul>
  </div>
  <!-- Cuts Orders Section -->
  <div *ngIf="userRole == 'cuts_employee'" class="notification-section">
    <h2 class="section-title">
      Ordenes nuevas
      <span class="notification-count">{{ cutsOrders.length }}</span>
    </h2>
    <ul>
      <li *ngFor="let notification of cutsOrders" class="relative">
        {{ getUpdatedDescription(notification.description) }}
        <button
          class="absolute top-1 right-1 cursor-pointer bg-red-500 text-white rounded p-1 hover:bg-red-600"
          (click)="deleteNotification(notification)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
            />
          </svg>
        </button>
      </li>
    </ul>
  </div>
  <!-- Prints Orders Section -->
  <div *ngIf="userRole == 'prints_employee'" class="notification-section">
    <h2 class="section-title">
      Ordenes nuevas
      <span class="notification-count">{{ printsOrders.length }}</span>
    </h2>
    <ul>
      <li *ngFor="let notification of printsOrders" class="relative">
        {{ getUpdatedDescription(notification.description) }}
        <button
          class="absolute top-1 right-1 cursor-pointer bg-red-500 text-white rounded p-1 hover:bg-red-600"
          (click)="deleteNotification(notification)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
            />
          </svg>
        </button>
      </li>
    </ul>
  </div>
    <!-- Plazos de Pago -->
  <div *ngIf="userRole === 'admin'" class="notification-section">
    <h2 class="section-title">
       Plazos de Pago Próximos a Vencer
      <span class="notification-count">{{ paymentDeadlines.length }}</span>
    </h2>

    <ul>
      <li *ngFor="let notification of paymentDeadlines" class="relative p-4 border-b">
        <div class="flex justify-between items-start">
          <!-- Notification Description -->
          <div>
            <p>{{ notification.description }}</p>
            <p class="text-xs text-gray-400">
              Vence: {{ notification.due_date | date : "dd-MM-yyyy" }}
            </p>
          </div>

          <!-- Delete Button -->
          <button
            class="absolute top-1 right-1 cursor-pointer bg-red-500 text-white rounded p-1 hover:bg-red-600"
            (click)="deleteNotification(notification)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="size-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
              />
            </svg>
          </button>
        </div>
      </li>
    </ul>
  </div>
  <div *ngIf="userRole === 'admin'" class="notification-section">
    <h2 class="section-title">
      Recordatorio
      <span class="notification-count">{{ reminders.length }}</span>
    </h2>
    <!-- Reminders Section -->

    <ul>
      <li *ngFor="let notification of reminders" class="relative p-4 border-b">
        <div class="flex justify-between items-start">
          <!-- Notification Description -->
          <div>
            <p>{{ notification.description }}</p>
            <p class="text-xs text-gray-400">
              Plazo: {{ notification.due_date | date : "dd-MM-yyyy" }}
            </p>
          </div>

          <!-- Button -->
          <button
            class="absolute top-1 right-12 cursor-pointer bg-yellow-500 text-white rounded p-1 hover:bg-yellow-600"
            (click)="selectNotification(notification)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"
              />
            </svg>
          </button>
          <button
            class="absolute top-1 right-1 cursor-pointer bg-red-500 text-white rounded p-1 hover:bg-red-600"
            (click)="deleteNotification(notification)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="size-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
              />
            </svg>
          </button>
        </div>
      </li>
    </ul>

    <button
      class="btn-add inline-flex items-center space-x-2"
      (click)="toggleReminderForm()"
    >
      <svg
        class="w-5 h-5 inline-block align-middle mt-[3px]"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12.75 9C12.75 8.58579 12.4142 8.25 12 8.25C11.5858 8.25 11.25 8.58579 11.25 9L11.25 11.25H9C8.58579 11.25 8.25 11.5858 8.25 12C8.25 12.4142 8.58579 12.75 9 12.75H11.25V15C11.25 15.4142 11.5858 15.75 12 15.75C12.4142 15.75 12.75 15.4142 12.75 15L12.75 12.75H15C15.4142 12.75 15.75 12.4142 15.75 12C15.75 11.5858 15.4142 11.25 15 11.25H12.75V9Z"
          fill="#ffffff"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12Z"
          fill="#ffffff"
        />
      </svg>
      <span>Añadir</span>
    </button>
  </div>
</div>
<!-- Form to add reminder -->
<div *ngIf="showAddReminderForm" class="modal-overlay">
  <div class="modal-content modal-h300">
    <h3 class="text-lg font-bold mb-4">Añadir Nuevo Recordatorio</h3>
    <form (ngSubmit)="generateReminder(reminderForm)">
      <div class="mb-4">
        <label class="block text-gray-700">Descripcion</label>
        <input
          [(ngModel)]="reminderForm.description"
          name="description"
          class="form-input mt-1 block w-full"
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700">Fecha</label>
        <input
          type="date"
          [(ngModel)]="reminderForm.due_date"
          name="due"
          class="form-input mt-1 block w-full"
        />
      </div>

      <div class="flex justify-end">
        <button type="button" class="btn-danger" (click)="toggleReminderForm()">
          Cancelar
        </button>
        <button type="submit" class="btn-success">Guardar Recordatorio</button>
      </div>
    </form>
  </div>
</div>
<!-- Form to update reminder -->
<div *ngIf="showEditReminderForm && selectedNotification" class="modal-overlay">
  <div class="modal-content modal-h300">
    <h3 class="text-lg font-bold mb-4">Editar Recordatorio</h3>
    <form (ngSubmit)="editReminder(selectedNotification)">
      <div class="mb-4">
        <label class="block text-gray-700">Descripcion</label>
        <input
          [(ngModel)]="selectedNotification.description"
          name="description"
          class="form-input mt-1 block w-full"
          placeholder="{{ selectedNotification.description }}"
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700">Fecha</label>
        <input
          type="date"
          [(ngModel)]="selectedNotification.due_date"
          name="due_date"
          class="form-input mt-1 block w-full"
          placeholder="{{ selectedNotification.due_date }}"
        />
      </div>

      <div class="flex justify-end">
        <button
          type="button"
          class="bg-gray-300 text-gray-700 px-4 py-2 rounded-md mr-2"
          (click)="toggleEditReminderForm()"
        >
          Cancelar
        </button>
        <button
          type="submit"
          style="
            background-color: red;
            color: white;
            border: 1px solid black;
            padding: 10px;
          "
          class="btn-success"
        >
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>
