<router-outlet></router-outlet>
<div
  class="login-container flex justify-center items-center min-h-screen bg-cover bg-center"
  style="background-image: url(/login.jpg)"
>
  <div
    class="login-box min-w-[280px] max-w-[350px] w-[80%] bg-white/80 backdrop-blur-md rounded-lg shadow-lg p-6"
  >
    <button
      (click)="goHome()"
      class="border-2 border-red-600 text-red-600 hover:text-white hover:bg-red-600 font-semibold p-2 rounded-md transition relative top left-0"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="size-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M7.49 12 3.74 8.248m0 0 3.75-3.75m-3.75 3.75h16.5V19.5"
        />
      </svg>
    </button>
    <div class="logo text-4xl font-bold text-center text-red-700 mb-8">
      La Casa del Acrilico
    </div>

    <div class="flex flex-col gap-4" [formGroup]="form">
      <div *ngIf="!isResetPasswordMode" class="flex flex-col gap-1">
        <div class="font-bold">Correo Electrónico</div>
        <input
          formControlName="email"
          placeholder="Ingresa tu correo"
          class="input-field p-2 w-full rounded-md"
        />
      </div>
      <div *ngIf="!isRecoveryMode && !isResetPasswordMode" class="flex flex-col gap-1">
        <div class="font-bold">Contraseña</div>
        <input
          formControlName="password"
          placeholder="Ingresa tu contraseña"
          type="password"
          class="input-field p-2 w-full rounded-md"
        />
        <button
          *ngIf="!isRegisterMode"
          (click)="toggleRecoveryMode()"
          class="text-sm text-left underline text-red-700 hover:text-red-900"
        >
          ¿Olvidaste tu contraseña?
        </button>
      </div>

      <!-- Solo se muestra en modo registro -->
      <div *ngIf="isRegisterMode" class="flex flex-col gap-1">
        <div class="font-bold">Repite la Contraseña</div>
        <input
          formControlName="confirmPassword"
          type="password"
          placeholder="Repite tu contraseña"
          class="input-field p-2 w-full rounded-md"
        />
        <div
          class="text-red-600 text-sm mt-1"
          *ngIf="form.hasError('passwordMismatch')"
        >
          Las contraseñas no coinciden
        </div>

        <!-- Campo nombre de usuario (solo en modo registro) -->
        <div class="font-bold">Nombre de Usuario</div>
        <input
          formControlName="user_name"
          placeholder="Ej: JuanP"
          class="input-field p-2 w-full rounded-md"
        />
      </div>

      <!-- Campos para RESET PASSWORD (cuando vienen del email) -->
      <div *ngIf="isResetPasswordMode" class="flex flex-col gap-1">
        <div class="font-bold">Nueva Contraseña</div>
        <input
          formControlName="password"
          type="password"
          placeholder="Ingresa tu nueva contraseña"
          class="input-field p-2 w-full rounded-md"
        />

        <div class="font-bold">Confirmar Nueva Contraseña</div>
        <input
          formControlName="confirmPassword"
          type="password"
          placeholder="Repite tu nueva contraseña"
          class="input-field p-2 w-full rounded-md"
        />
        <div
          class="text-red-600 text-sm mt-1"
          *ngIf="form.hasError('passwordMismatch')"
        >
          Las contraseñas no coinciden
        </div>
      </div>

      <button
        *ngIf="!isRegisterMode && !isRecoveryMode && !isResetPasswordMode"
        (click)="login()"
        class="btn-login border-2 border-red-600 text-red-600 hover:text-white hover:bg-red-600 font-semibold p-2 w-full rounded-md transition"
      >
        Ingresar
      </button>

      <button
        *ngIf="isRegisterMode"
        (click)="signUp()"
        class="btn-register border-2 border-red-600 text-red-600 hover:text-white hover:bg-red-600 font-semibold p-2 w-full rounded-md transition"
      >
        Registrarse
      </button>

      <button
        *ngIf="isRecoveryMode"
        (click)="sendRecoveryEmail()"
        class="btn-register border-2 border-red-600 text-red-600 hover:text-white hover:bg-red-600 font-semibold p-2 w-full rounded-md transition"
      >
        Enviar correo de recuperación
      </button>

      <button
        *ngIf="isResetPasswordMode"
        (click)="updatePassword()"
        class="btn-register border-2 border-red-600 text-red-600 hover:text-white hover:bg-red-600 font-semibold p-2 w-full rounded-md transition"
      >
        Actualizar Contraseña
      </button>

      <button
        *ngIf="!isRecoveryMode && !isResetPasswordMode"
        (click)="toggleMode()"
        class="text-sm text-center underline text-red-700 hover:text-red-900 mt-2"
      >
        {{
          isRegisterMode
            ? "¿Ya tienes cuenta? Inicia sesión"
            : "¿No tienes cuenta? Regístrate aquí"
        }}
      </button>

      <!-- Volver desde recovery mode -->
      <button
        *ngIf="isRecoveryMode"
        (click)="toggleRecoveryMode()"
        class="text-sm text-center underline text-red-700 hover:text-red-900 mt-2"
      >
        Volver al inicio de sesión
      </button>

      <!-- Mensaje de éxito/info -->
      <p *ngIf="message" class="text-sm text-green-700 text-center mt-2">
        {{ message }}
      </p>
    </div>
  </div>
</div>
